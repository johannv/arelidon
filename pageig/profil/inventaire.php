<?phpif(isset($_GET['usecase']))    require_once('../../require.php');require_once($server.'class/classe.class.php');require_once ($server.'class/services/body_parts.class.php');require_once ($server.'class/char_equip.class.php');require_once ($server.'class/char_inv.class.php');$char = unserialize($_SESSION['char']);$char_inv = new char_inv($char->getId());$char_equip = new char_equip($char->getId());if(empty($_GET['restrict']))    $_GET['restrict'] = 'tous';if(empty($_GET['min']))     $_GET['min'] = 10;if(empty($_GET['max'])) $_GET['max'] = 100;if(empty($_GET['usecase'])) $_GET['usecase'] = '';switch($_GET['usecase']){	case 'use':		$item = new item($_GET['item_id']);		$char_inv->useItem($item,$char);	break;	case 'equip':		$item = new item($_GET['item_id']);		$char_equip->equip($item);	break;	case 'drop':		$item = new item($_GET['item_id']);		$char_inv->drop($item,$char);	break;	case 'unequip':                		$char_equip->unequip($_GET['body_part']);	break;	default:			break;}		echo '<div id="body" style="float:left;margin-left:30px;width:140px;height:230px;border:solid 1px grey;background-image:url(\'pictures/utils/ombre.gif\');background-color:white;">';			// Equipement                        $char_equip = new char_equip($char->getId());                        			$arrayEquip = $char_equip->getAllEquipement();                        $body_parts = body_parts::getAllBodyParts();			                                                			foreach($body_parts as $body_part)			{				$style = body_parts::getEquipShowStyle($body_part['name'],false);					$spanstyle= "width:150px;";                                $print_item = false;                                $item_id = '';                              foreach($arrayEquip as $item)                              {                                    if($body_part['id'] == 1)                                {                                                                        if($item['place'] == 1 or $item['place'] == 3)                                    {                                        $item_id = $item['item_id'];                                        $print_item = true;                                        break;                                    }                                                                                                        }                                else                                {                                    if($item['place'] == $body_part['id'])                                     {                                        $print_item = true;                                        $item_id = $item['item_id'];                                        break;                                    }                                                                    }                              }//                                pre_dump($print_item);				if($print_item)				{					$item = new item($item_id);				                                                                                                                        					$onclick="HTTPTargetCall('pageig/profil/inventaire.php?usecase=unequip&body_part=".$body_part['id']."','Inventaire');";// = $item->actionAndRefresh('unequip',$restrict,$min,$max);					echo '<div style="'.$style.';width:32px;height:32px;background-image:url(pictures/utils/cadre32x32.png);padding-top:2px;">';						echo '<div style="height:2px;"></div>';                                                $item->getPictureWithToolTip($onclick,'','margin-left:5px;',$spanstyle,false);					echo '</div>';				}else{					echo '<div style="'.$style.';width:32px;height:32px;">';						echo '<img src="pictures/utils/cadre32x32.png" alt="" title="'.$body_part['name'].'" />';					echo '</div>';				}	                              			}					echo '</div>';		echo '<div style="float:left;margin-left:30px;margin-top:20px;min-width:250px;">';				$char_inv = new char_inv($char->getId());                        $items = $char_inv->getAllItem($_GET['restrict']);                                                foreach($items as $item_information)                        {                            $item = new item($item_information['item_id']);                                                        if($item->getTypeItem() > 0 && $item->getTypeItem() < 16)                                            $class = ' item equipable';                                        elseif($item->getTypeItem() == 999)                                            $class = ' item comsumable';                                        else                                           $class = '';                            echo $item_information['number'],'X ',$item->getPictureWithToolTip('','','','','',$class,$item->getId()),' ',$item->getName();                            echo '<img src="pictures/icones/addfav.gif" alt="raccourcisR" onclick="HTTPTargetCall(\'pageig/profil/inventaire.php?usecase=addfavR&item_id='.$item->getId().'\',\'Inventaire\');"/>';                            echo '<img src="pictures/icones/addfav.gif" alt="raccourcisT" onclick="HTTPTargetCall(\'pageig/profil/inventaire.php?usecase=addfavT&item_id='.$item->getId().'\',\'Inventaire\');"/>';                            echo '<img src="pictures/icones/supp.gif" alt="drop" onclick="HTTPTargetCall(\'pageig/profil/inventaire.php?usecase=drop&item_id='.$item->getId().'\',\'Inventaire\');" />';                            echo '<br/>';                        }	echo '</div>';            ?>    <img class="trash" src="../pictures/utils/funny.jpg"/><div class="popup">    <a class="closepopup">x</a>        <form action="">                <label for="number"></label>        <input type="text" id="number" name="number" value="1"/>        <input type="button" value="DÃ©poser"/>    </form></div><div class="background">    </div><script type="text/javascript">        $(document).ready()    {        $(".item").draggable({revert: "invalid"});                $("#body").droppable({accept: ".item",            drop: function(event, ui)            {                                if(ui.draggable.hasClass('equipable'))                {                                        HTTPTargetCall('pageig/profil/inventaire.php?usecase=equip&item_id=' + ui.draggable.find("input").val() ,'Inventaire');                }                                if(ui.draggable.hasClass('comsumable'))                {                                        HTTPTargetCall('pageig/profil/inventaire.php?usecase=use&item_id=' + ui.draggable.find("input").val() ,'Inventaire');                }            }                                });                $("#trash").droppable({accept: ".item",            drop: function(event, ui)            {                                          }                                });    };             </script>     